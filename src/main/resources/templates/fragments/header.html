<!doctype html>
<html
  xmlns:th="https://www.thymeleaf.org"
  xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity"
>
  <header
    th:fragment="header"
    class="navbar navbar-expand-lg shadow-sm"
    style="background: linear-gradient(90deg, #8d5524, #d97706)"
  >
    <div class="container py-2">
      <!-- Brand -->
      <a
        class="navbar-brand fw-bold text-white d-flex align-items-center"
        th:href="@{/}"
      >
        <i class="bi bi-music-note-beamed fs-4 me-2"></i>
        My Favourite Composer
      </a>

      <!-- Toggle -->
      <button
        class="navbar-toggler text-white border-0"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#mainNavbar"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Menu -->
      <div class="collapse navbar-collapse" id="mainNavbar">
        <ul class="navbar-nav ms-auto gap-lg-3">
          <!-- Composers -->
          <li class="nav-item">
            <a
              th:href="@{/show/composer}"
              class="nav-link text-white fw-medium"
            >
              <i class="bi bi-person-lines-fill me-1"></i> Composers
            </a>
          </li>

          <!-- Musical Pieces -->
          <li class="nav-item">
            <a
              th:href="@{/show/music-piece}"
              class="nav-link text-white fw-medium"
            >
              <i class="bi bi-music-note-list me-1"></i> Musical Pieces
            </a>
          </li>

          <!-- Management -->
          <li sec:authorize="hasRole('ADMIN')" class="nav-item dropdown">
            <a
              class="nav-link dropdown-toggle text-white fw-medium"
              role="button"
              data-bs-toggle="dropdown"
            >
              <i class="bi bi-gear me-1"></i> Management
            </a>

            <ul class="dropdown-menu dropdown-menu-end shadow-sm">
              <li>
                <a th:href="@{/add/composer}" class="dropdown-item">
                  <i class="bi bi-person-plus me-2"></i> Add Composer
                </a>
              </li>

              <li>
                <a th:href="@{/add/music-piece}" class="dropdown-item">
                  <i class="bi bi-file-music me-2"></i> Add Musical Piece
                </a>
              </li>

              <li>
                <a th:href="@{/composer-pagination-list}" class="dropdown-item">
                  <i class="bi bi-list-ul me-2"></i> Composer List
                </a>
              </li>

              <li><hr class="dropdown-divider" /></li>

              <li>
                <a th:href="@{/users}" class="dropdown-item">
                  <i class="bi bi-people me-2"></i> User Management
                </a>
              </li>
            </ul>
          </li>

          <!-- Register -->
          <li class="nav-item">
            <a th:href="@{/new}" class="nav-link text-white fw-medium">
              Register
            </a>
          </li>

          <!-- Login -->
          <li class="nav-item">
            <a th:href="@{/signin}" class="nav-link text-white fw-medium">
              Login
            </a>
          </li>

          <!-- Logout -->
          <li class="nav-item">
            <a th:href="@{/signout}" class="nav-link text-white fw-medium">
              Logout
            </a>
          </li>

          <!-- Username -->
          <li class="nav-item">
            <span
              sec:authentication="name"
              class="nav-link text-white fw-medium"
            ></span>
          </li>

          <!-- Deletecookies -->
          <li class="nav-item">
            <a th:href="@{/theme/delete}" class="nav-link text-white fw-medium">
              Delete Cookies
            </a>
          </li>
        </ul>

        <!-- THEME CONTROLS -->
        <div class="d-flex align-items-center ms-3 gap-2">
          <!-- THEME SWITCH (SESSION COOKIE) -->
          <form
            th:action="@{/theme}"
            method="post"
            class="d-flex align-items-center gap-2"
          >
            <!-- CSRF -->
            <input
              type="hidden"
              th:name="${_csrf.parameterName}"
              th:value="${_csrf.token}"
            />

            <!-- DARK -->
            <button
              type="submit"
              name="mode"
              value="dark"
              class="btn btn-sm btn-dark d-flex align-items-center gap-1"
              title="Dark mode (session)"
            >
              <i class="bi bi-moon-fill"></i>
              <span class="d-none d-lg-inline">Dark</span>
            </button>

            <!-- LIGHT -->
            <button
              type="submit"
              name="mode"
              value="light"
              class="btn btn-sm btn-light d-flex align-items-center gap-1"
              title="Light mode (session)"
            >
              <i class="bi bi-sun-fill"></i>
              <span class="d-none d-lg-inline">Light</span>
            </button>
          </form>

          <!-- DARK (1 MINUTE COOKIE) -->
          <form th:action="@{/theme/minute}" method="post" class="d-inline">
            <input
              type="hidden"
              th:name="${_csrf.parameterName}"
              th:value="${_csrf.token}"
            />

            <button
              name="mode"
              value="dark"
              class="btn btn-sm btn-secondary d-flex align-items-center gap-1"
              title="Dark mode (1 minute)"
              type="submit"
            >
              <i class="bi bi-hourglass-split"></i>
              <span class="d-none d-lg-inline">Dark (1 min)</span>
            </button>
          </form>
        </div>
      </div>
    </div>
  </header>
</html>
